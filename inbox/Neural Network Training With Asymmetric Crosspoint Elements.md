### abstract
프로그래밍 가능한 비휘발성 저항으로 구성된 아날로그 크로스바 어레이는 심층 신경망 훈련의 가속화를 위해 집중적으로 연구되고 있습니다. 그러나 실제 저항 소자의 유비쿼터스 비대칭 전도도 변조는 기존 알고리즘으로 훈련된 네트워크의 분류 성능을 심각하게 저하시킵니다.
여기에서는 먼저 이러한 비호환성의 근본적인 이유를 설명합니다. 그런 다음 비대칭 교차점 요소와 호환되는 새로운 완전 병렬 훈련 알고리즘의 이론적 토대를 설명합니다. 고전 역학과의 강력한 비유를 통해 장치 비대칭성을 아날로그 딥 러닝 프로세서의 유용한 기능으로 활용하는 방법을 설명합니다.
기존의 오차 함수 기울기 방향으로 가중치를 조정하는 대신, 네트워크 파라미터를 프로그래밍하여 소자 비대칭의 효과를 통합한 시스템의 총 에너지(해밀턴)를 성공적으로 최소화할 수 있습니다. 이 기술을 사용하면 쉽게 구할 수 있는 장치 기술을 기반으로 아날로그 딥 러닝 가속기를 즉시 구현할 수 있습니다.

### Introduction
딥러닝은 객체 인식, 자연어 처리, 생물정보학 등의 분야에서 여러 수준의 추상화에서 데이터의 표현을 분류하고 클러스터링함으로써 이점을 얻는 패러다임의 변화를 일으켰습니다(Lecun et al., 2015). 그러나 최첨단 심층 신경망(DNN)을 훈련하기 위한 계산 워크로드는 데이터센터에 막대한 계산 시간과 에너지 비용을 요구합니다(Strubell et al., 2020).
일반적으로 더 큰 데이터 세트로 훈련된 더 큰 신경망이 더 나은 성능을 제공하기 때문에 이러한 추세는 앞으로 더욱 가속화될 것으로 예상됩니다. 그 결과, 딥러닝을 위한 빠르고 에너지 효율적인 솔루션을 제공해야 할 필요성으로 인해 업계와 학계에서 대규모 공동 연구가 진행되고 있습니다(Chen et al., 2016; Jouppi et al., 2017; Rajbhandari et al., 2020). 고도로 최적화된 디지털 애플리케이션별 집적 회로(ASIC) 구현은 계산 집약적인 행렬 연산을 위해 정밀도 감소 연산을 사용하여 DNN 워크로드를 가속화하려고 시도해 왔습니다. 추론 작업의 가속화는 2비트 해상도를 사용하여 달성되었지만(Choi et al., 2019), 학습 작업에는 최소한 하이브리드 8비트 부동 소수점 형식이 필요한 것으로 밝혀졌습니다(Sun et al., 2019). 이는 대규모 네트워크에 여전히 상당한 에너지 소비와 처리 시간을 부과합니다. 따라서 학습 워크로드를 효율적으로 처리할 수 있는 비디지털 접근 방식이 활발히 모색되고 있습니다.

아날로그 저항 크로스바 어레이를 사용한 인메모리 계산 개념은 유망한 대안으로 집중적으로 연구되고 있습니다. 이러한 프레임워크는 옴의 법칙과 키르히호프의 법칙을 사용하여 전체 계산 부하의 ≈ 2/3를 차지하는 병렬 벡터 행렬 곱셈(자세한 내용은 부록 2.1, 2.2 참조)을 수행하도록 처음 설계되었습니다(Steinbuch, 1961). 그러나 업데이트 주기 동안 나머지 ≈ 1/3의 연산도 병렬화하지 않으면 아날로그 어레이가 제공하는 가속 계수는 기존 디지털 프로세서와 비교했을 때 기껏해야 3배에 불과합니다.
나중에 펄스 일치와 디바이스 전도도의 점진적 변화를 사용하여 1등급 외부 제품도 병렬로 달성할 수 있다는 사실이 밝혀졌습니다(Burr et al., 2015; Gokmen and Vlasov, 2016). 이 방법을 사용하면 외부 곱1을 명시적으로 계산하거나 개별 크로스포인트 요소의 값을 읽을 필요 없이 전체 크로스바 어레이를 병렬로 업데이트할 수 있습니다(Gokmen et al., 2017). 그 결과, 확률적 경사 하강(SGD) 알고리즘을 사용하는 DNN 훈련의 모든 기본 요소는 아날로그 크로스바 아키텍처를 사용하여 완전 병렬 방식으로 수행될 수 있습니다.
그러나 이 병렬 업데이트 방식은 크로스포인트 요소의 컨덕턴스 변조 특성에 따라 성능이 크게 영향을 받기 때문에 엄격한 디바이스 요구 사항이 부과됩니다. 특히 비대칭 컨덕턴스 변조 특성(즉, 양의 컨덕턴스와 음의 컨덕턴스 조정이 불일치하는 경우)은 부정확한 기울기 축적을 유발하여 분류 정확도를 저하시키는 것으로 밝혀졌습니다(Yu et al., 2015; Agarwal et al., 2016, 2017; Gokmen and Vlasov, 2016; Gokmen et al., 2017, 2018; Ambrogio et al., 2018). 안타깝게도 현재까지 모든 아날로그 저항 소자는 비대칭적인 특성을 가지고 있어 아날로그 딥러닝 프로세서를 실현하는 데 큰 기술적 장벽이 되고 있습니다.

이상적인 저항 소자를 설계하려는 광범위한 노력(Woo and Yu, 2018; Fuller et al., 2019; Grollier et al., 2020; Yao et al., 2020)과 더불어 소자의 비대칭성을 해결하기 위한 많은 높은 수준의 완화 기술이 제안되어 왔습니다. 수많은 시뮬레이션 및 실험적 시연이 발표되었지만, 지금까지 어떤 연구도 아날로그 프로세서의 본래 목적인 에너지 효율적인 딥러닝 가속을 달성할 수 있는 솔루션을 제공하지 못했습니다.
기존 기술의 핵심적인 문제는 크로스포인트 요소에 하나씩 또는 행 단위로 직렬로 액세스해야 한다는 점입니다(Prezioso et al., 2015; Yu et al., 2015; Agarwal et al., 2017; Burr et al., 2017; Ambrogio et al., 2018; Li et al., 2018, 2019; Cai et al., 2019; Sebastian et al., 2020). 직렬 연산과 관련된 방법에는 전도도 값을 개별적으로 읽고, 인위적으로 대칭 변조를 강제하는 업데이트 펄스를 엔지니어링하고, 주기적으로 가중치를 운반하거나 리셋하는 방법이 포함됩니다. 또한 일부 접근 방식은 경사도 계산을 디지털 프로세서로 오프로드하는데, 이 경우 아날로그 행렬의 직렬 프로그래밍이 필요할 뿐만 아니라 외부 곱 계산 비용도 부담해야 합니다(Prezioso 등, 2015; Yu 등, 2015; Li 등, 2018, 2019; Cai 등, 2019; Sebastian 등, 2020).
이러한 직렬 루틴으로 N × N 크로스바 배열을 업데이트하려면 최소 N 개 또는 N2 개의 연산이 필요합니다. 실제 배열 크기의 경우, 업데이트 주기에 너무 많은 계산 시간과 에너지가 소요됩니다. 결론적으로, 병렬성을 타협하는 구현의 경우 기존 디지털 프로세서에 비해 계산 처리량과 에너지 효율성 이점이 실제 애플리케이션에서 사라지기 때문에 비대칭성 문제가 해결되었는지 여부는 중요하지 않게 됩니다. 따라서 완전 병렬 연산만 사용하면서 디바이스 비대칭 문제를 해결할 수 있는 방법을 고안하는 것이 시급합니다.

최근 우리 그룹은 비대칭 변조 특성을 가진 비대칭 저항 소자를 기반으로 DNN을 성공적으로 훈련할 수 있는 새로운 완전 병렬 훈련 방법인 Tiki-Taka를 제안했습니다(Gokmen and Haensch, 2020). 이 알고리즘은 비대칭 디바이스 모델로 에뮬레이트된 다양한 네트워크 유형과 크기에 대해 이상적인 디바이스 수준의 분류 정확도를 제공하는 것으로 시뮬레이션을 통해 경험적으로 입증되었습니다(Gokmen and Haensch, 2020). 그러나 제안된 알고리즘 솔루션의 이론적 토대가 부족하고 아날로그 하드웨어를 두 배로 늘리는 데 드는 비용으로 인해 이전에는 Gokmen과 Haensch(2020)에서 설명한 방법이 제한적이었습니다.

이 백서에서는 먼저 디바이스 비대칭성이 SGD 기반 훈련의 근본적인 문제인 이유를 이론적으로 설명합니다. 그리고 고전 역학과의 강력한 유추를 통해 티키-타카 알고리즘이 소자 비대칭의 효과를 통합하여 시스템의 총 에너지(해밀턴)를 최소화한다는 사실을 입증합니다. 본 연구에서는 이 새로운 방법을 확률적 해밀턴 하강(Stochastic Hamiltonian Descent, SHD)으로 공식화하고 완전 병렬 훈련에서 디바이스 비대칭성을 유용한 기능으로 활용할 수 있는 방법을 설명합니다. 고급 물리적 직관을 통해 기존 알고리즘을 개선하고 하드웨어 비용을 50% 절감하여 실질적인 관련성을 향상시킬 수 있었습니다. 다양한 디바이스 제품군에 대한 시뮬레이션 훈련 결과를 사용하여 SHD가 모든 적용 가능한 시나리오에서 SGD 기반 훈련에 비해 더 나은 분류 정확도와 더 빠른 수렴을 제공한다는 결론을 내렸습니다. 이 백서의 내용은 차세대 크로스포인트 요소와 아날로그 컴퓨팅을 위한 특수 알고리즘에 대한 가이드라인을 제공합니다.
